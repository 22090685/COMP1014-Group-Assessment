---
title: "Question 5"
author: '22090685'
date: "2025-05-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

###### Load csv File

``` {r}
# Load csv file
SleepCogStudy <- read.csv("Resources/Sleep_Cognition_Study_f1PhaXA.csv")

```

## Question 5.
## Test if screen time before bed can be used to predict average sleep duration among office workers.
### Visualisation of relevant Data
``` {r}
# Filter data to office workers
office_data <- subset(SleepCogStudy, OccupationType == "Office Worker")

# Plot the filtered data
plot(office_data$ScreenTimeBeforeBed, office_data$AverageSleepDuration,
     main = "Sleep Duration vs. Screen Time (Office Workers)",
     xlab = "Screen Time before bed (minutes)",
     ylab = "Average Sleep Duration (hours)",
     pch = 19, col = "black")
```

### Initial Observations:
#####  It can be observed that the scatter plot suggests a negative linear trend between the increase of screen Time and the decrease of the average duration of sleep. As such, it is expected that the increase of screentime before bed reduces the average sleep duration. This leads to the observation that a linear regression model would be most suitable to conduct the test.

### Analysis: Testing if Screentime predicts Sleep Duration
#### Hypothesis:
###### H0: Screentime does not predict sleep duration (βA = 0)
###### HA: Screentime predict sleep duration (βA ≠ 0)
``` {r}
# Fit linear regression model 
fit <- lm(AverageSleepDuration ~ ScreenTimeBeforeBed, data = office_data)
summary(fit)


#plot Sleep Duration vs. Screen Time 
plot(office_data$ScreenTimeBeforeBed, office_data$AverageSleepDuration,
     main = "Sleep Duration vs. Screen Time (Office Workers)",
     xlab = "Screen Time before bed (minutes)",
     ylab = "Average Sleep Duration (hours)",
     pch = 19, col = "black")
abline(fit, col = "red", lwd = 2)

# Coefficients
coef(fit)



# Confidence intervals
confint(fit)




# ANOVA table
anova(fit)

```
####    Assess the strength of the predictive power of the model.
``` {r}
summary(fit)$r.squared  # R-squared value
summary(fit)$adj.r.squared  # Adjusted R-squared
```

##### The null hypothesis is rejected as the the p-value of the model (3.411e-05) is greater than the test statistic at a 5% significance level - indicative that screen time has strong statistical significance. The r^2 value of ~ 0.23 suggests that only around 23% of the variation in sleep duration can be explained by the number of screen time before bed. 

####  Residuals: 
##### It is observered that the residual points of data are spread randomly around 0. This suggests that the variability does not seem to be reliant on either the x or y axis

``` {r}
# Residual plot
plot(fit$residuals,
     main = "Residuals of the Model",
     ylab = "Residuals",
     xlab = "Index",
     pch = 19,
     col = "blue")
abline(h = 0, col = "red", lty = 2)
```

#### Errors:
##### Error in xy.coords(x, y, xlabel, ylabel, log) : 'x' and 'y' lengths differ
##### Error was caused by obtaining data values from the incorrect origin of 'SleepCogStudy', and not the subset 'office_data'. Once the origin was corrected, the scattterplot displayed the intended points of data.
 
### Ai Usage:
##### Ai (ChatGPT) was utilised in the formatting of the file, and providing input on how to present my report following best practices. Methods that were generated by chatGPT had been discarded due to oversimplifying my work to a level that I had difficulty understanding. One such case was the use of '% in % ' in place of my preference to filter the office.data into a vector.
